<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tickets La Perla del Caribe & Los Chamos</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f7f7f7;
      margin: 0; padding: 0;
      display: flex; flex-direction: column; align-items: center;
      min-height: 100vh;
    }
    h1 {
      margin: 1rem 0;
    }
    .tabs {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
    }
    .tab {
      padding: 0.75rem 1.5rem;
      background: #4caf50;
      color: white;
      border-radius: 10px;
      cursor: pointer;
      user-select: none;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    .tab.active {
      background: #388e3c;
      font-weight: bold;
    }
    .section {
      max-width: 400px;
      width: 90vw;
      background: white;
      border-radius: 10px;
      padding: 1rem;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      margin-bottom: 1rem;
    }
    .button-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 0.5rem;
    }
    button.product-btn {
      padding: 1rem;
      font-size: 1.2rem;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      user-select: none;
      color: white;
      font-weight: bold;
    }
    button.product-btn.chamos-btn {
      background-color: #2196f3;
    }
    button.product-btn.chamos-btn:active {
      background-color: #1976d2;
    }
    button.product-btn.perla-btn {
      background-color: #4caf50;
    }
    button.product-btn.perla-btn:active {
      background-color: #388e3c;
    }
    #total {
      font-size: 1.5rem;
      margin-bottom: 0.5rem;
      color: #333;
      font-weight: bold;
    }
    #ticket-lists {
      font-family: monospace;
      white-space: pre-line;
      text-align: center;
      color: #333;
      margin-bottom: 1rem;
      font-size: 1.5rem;
    }
    button#print, button#reset {
      width: 90vw;
      max-width: 400px;
      padding: 1rem;
      font-size: 1.1rem;
      border: none;
      border-radius: 10px;
      margin-bottom: 1rem;
      cursor: pointer;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      user-select: none;
    }
    button#print {
      background-color: #2196f3;
      color: white;
    }
    button#print:active {
      background-color: #1976d2;
    }
    button#reset {
      background-color: #f44336;
      color: white;
    }
    button#reset:active {
      background-color: #d32f2f;
    }
    .remove-item {
      color: red;
      font-weight: bold;
      cursor: pointer;
      margin-left: 8px;
    }
    .tab[data-tab="chamos"] {
      background-color: #2196f3;
      color: white;
    }
    /* Historial estilos */
    #historial {
      max-width: 400px;
      width: 90vw;
      background: white;
      border-radius: 10px;
      padding: 1rem;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      margin-bottom: 2rem;
      font-size: 1rem;
      color: #333;
    }
    #historial h3 {
      margin-top: 1rem;
      border-bottom: 2px solid #4caf50;
      padding-bottom: 0.3rem;
    }
    #historial div {
      margin-bottom: 1rem;
      border-bottom: 1px solid #ccc;
      padding-bottom: 0.5rem;
    }
    #historial ul {
      margin: 0.3rem 0 0 1rem;
      padding-left: 0;
    }
    #historial li {
      list-style-type: disc;
      margin-left: 1rem;
    }
  </style>
</head>
<body>

  <h1>Tickets La Perla del Caribe & Los Chamos</h1>

  <div class="tabs">
    <div class="tab active" data-tab="chamos">Los Chamos</div>
    <div class="tab" data-tab="perla">La Perla del Caribe</div>
  </div>

  <div id="chamos" class="section tab-content">
    <div class="button-grid">
      <button class="product-btn chamos-btn" onclick="addProduct('Tequeños', 9.99, 'chamos')">Tequeños - 9,99€</button>
      <button class="product-btn chamos-btn" onclick="addProduct('Patatas Locas XL', 11.99, 'chamos')">Patatas Locas XL - 11,99€</button>
      <button class="product-btn chamos-btn" onclick="addProduct('Alitas de pollo BBQ', 14.99, 'chamos')">Alitas BBQ - 14,99€</button>
      <button class="product-btn chamos-btn" onclick="addProduct('Tajadas de plátano', 7.99, 'chamos')">Tajadas - 7,99€</button>
      <button class="product-btn chamos-btn" onclick="addProduct('Arepa Pelua', 8.99, 'chamos')">Arepas Pelua - 8,99€</button>
      <button class="product-btn chamos-btn" onclick="addProduct('Arepa Sifrina', 8.99, 'chamos')">Arepas Sifrina - 8,99€</button>
      <button class="product-btn chamos-btn" onclick="addProduct('Arepa Reina Pepiada', 7.99, 'chamos')">Arepas Reina - 7,99€</button>
      <button class="product-btn chamos-btn" onclick="addProduct('Arepa Popular', 7.99, 'chamos')">Arepas Popular - 7,99€</button>
      <button class="product-btn chamos-btn" onclick="addProduct('Arepa Los Chamos', 9.99, 'chamos')">Arepas Chamos - 9,99€</button>
      <button class="product-btn chamos-btn" onclick="addProduct('Arepa Veguis', 9.99, 'chamos')">Arepas Veguis - 9,99€</button>
      <button class="product-btn chamos-btn" onclick="addProduct('Arepa Pabellón', 11.99, 'chamos')">Arepas Pabellón - 11,99€</button>
      <button class="product-btn chamos-btn" onclick="addProduct('Arepa Chevere', 11.99, 'chamos')">Arepas Chevere - 11,99€</button>
      <button class="product-btn chamos-btn" onclick="addProduct('Arepa Mixta', 11.99, 'chamos')">Arepas Mixta - 11,99€</button>
      <button class="product-btn chamos-btn" onclick="addProduct('Patacón Mortal', 14.99, 'chamos')">Patacón Mortal - 14,99€</button>
      <button class="product-btn chamos-btn" onclick="addProduct('Patacón Los Chamos', 11.99, 'chamos')">Patacón Los Chamos - 11,99€</button>
      <button class="product-btn chamos-btn" onclick="addProduct('Perrito Venezolano', 4.99, 'chamos')">Perrito Venezolano - 4,99€</button>
      <button class="product-btn chamos-btn" onclick="addProduct('Perrito Sencillo', 3.50, 'chamos')">Perrito Sencillo - 3,50€</button>
      <button class="product-btn chamos-btn" onclick="addProduct('Perrito Los Chamos', 6.50, 'chamos')">Perrito Los Chamos - 6,50€</button>
      <button class="product-btn chamos-btn" onclick="addProduct('Hamburguesa Los Chamos', 11.99, 'chamos
      <button class="product-btn chamos-btn" onclick="addProduct('Hamburguesa Los Chamos', 11.99, 'chamos')">Hamburguesa Los Chamos - 11,99€</button>
      <button class="product-btn chamos-btn" onclick="addProduct('Hamburguesa Chevere', 13.99, 'chamos')">Hamburguesa Chevere - 13,99€</button>
      <button class="product-btn chamos-btn" onclick="addProduct('Hamburguesa Mixta', 14.99, 'chamos')">Hamburguesa Mixta - 14,99€</button>
      <button class="product-btn chamos-btn" onclick="addProduct('Hamburguesa Vegana', 12.99, 'chamos')">Hamburguesa Vegana - 12,99€</button>
      <button class="product-btn chamos-btn" onclick="addProduct('Hamburguesa Popular', 11.99, 'chamos')">Hamburguesa Popular - 11,99€</button>
      <button class="product-btn chamos-btn" onclick="addProduct('Hamburguesa Doble', 15.99, 'chamos')">Hamburguesa Doble - 15,99€</button>
    </div>
  </div>

  <div id="perla" class="section tab-content" style="display:none;">
    <div class="button-grid">
      <button class="product-btn perla-btn" onclick="addProduct('Cerveza Polar', 3.50, 'perla')">Cerveza Polar - 3,50€</button>
      <button class="product-btn perla-btn" onclick="addProduct('Coca-Cola', 2.00, 'perla')">Coca-Cola - 2,00€</button>
      <button class="product-btn perla-btn" onclick="addProduct('Agua Mineral', 1.50, 'perla')">Agua Mineral - 1,50€</button>
      <button class="product-btn perla-btn" onclick="addProduct('Jugo Natural', 2.50, 'perla')">Jugo Natural - 2,50€</button>
      <button class="product-btn perla-btn" onclick="addProduct('Ron Cartavio', 4.00, 'perla')">Ron Cartavio - 4,00€</button>
      <button class="product-btn perla-btn" onclick="addProduct('Pisco Sour', 5.00, 'perla')">Pisco Sour - 5,00€</button>
      <button class="product-btn perla-btn" onclick="addProduct('Chicha Morada', 3.00, 'perla')">Chicha Morada - 3,00€</button>
      <button class="product-btn perla-btn" onclick="addProduct('Inca Kola', 2.00, 'perla')">Inca Kola - 2,00€</button>
    </div>
  </div>

  <div id="ticket-lists" class="section" style="white-space: pre-wrap;"></div>

  <div id="total" class="section">Total: 0,00€</div>

  <button id="print" class="section" onclick="printTickets()">Imprimir Tickets</button>
  <button id="reset" class="section" onclick="resetAll()">Reiniciar</button>

  <div id="historial" class="section">
    <h2>Historial de Tickets</h2>
  </div>

<script>
  // Variables para almacenar los productos seleccionados separados por negocio
  let productosChamos = [];
  let productosPerla = [];

  // Cambiar tab y mostrar el contenido correspondiente
  const tabs = document.querySelectorAll('.tab');
  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      tabs.forEach(t => t.classList.remove('active'));
      tab.classList.add('active');
      const tabName = tab.getAttribute('data-tab');
      document.querySelectorAll('.tab-content').forEach(tc => {
        tc.style.display = 'none';
      });
      document.getElementById(tabName).style.display = 'block';
    });
  });

  function addProduct(nombre, precio, negocio) {
    const producto = { nombre, precio };
    if (negocio === 'chamos') {
      productosChamos.push(producto);
    } else if (negocio === 'perla') {
      productosPerla.push(producto);
    }
    actualizarTickets();
  }

  function actualizarTickets() {
    let textoChamos = '--- Los Chamos ---\n';
    let totalChamos = 0;
    productosChamos.forEach(p => {
      textoChamos += `${p.nombre} - ${p.precio.toFixed(2)}€\n`;
      totalChamos += p.precio;
    });
    textoChamos += `Total Los Chamos: ${totalChamos.toFixed(2)}€\n\n`;

    let textoPerla = '--- La Perla del Caribe ---\n';
    let totalPerla = 0;
    productosPerla.forEach(p => {
      textoPerla += `${p.nombre} - ${p.precio.toFixed(2)}€\n`;
      totalPerla += p.precio;
    });
    textoPerla += `Total La Perla: ${totalPerla.toFixed(2)}€\n`;

    // Mostrar tickets separados
    document.getElementById('ticket-lists').textContent = textoChamos + textoPerla;

    // Mostrar total global
    const totalGlobal = totalChamos + totalPerla;
    document.getElementById('total').textContent = `Total General: ${totalGlobal.toFixed(2)}€`;
  }

  function printTickets() {
    if (productosChamos.length === 0 && productosPerla.length === 0) {
      alert('No hay productos para imprimir');
      return;
    }

    const fecha = new Date().toLocaleString();

    // Preparar textos separados para impresión
    let textoImpresion = '';

    if (productosChamos.length > 0) {
      textoImpresion += '--- Los Chamos ---\n';
      productosChamos.forEach(p => {
        textoImpresion += `${p.nombre} - ${p.precio.toFixed(2)}€\n`;
      });
      let totalChamos = productosChamos.reduce((acc, p) => acc + p.precio, 0);
      textoImpresion += `Total Los Chamos: ${totalChamos.toFixed(2)}€\n\n`;
    }

    if (productosPerla.length > 0) {
      textoImpresion += '--- La Perla del Caribe ---\n';
      productosPerla.forEach(p => {
        textoImpresion += `${p.nombre} - ${p.precio.toFixed(2)}€\n`;
      });
      let totalPerla = productosPerla.reduce((acc, p) => acc + p.precio, 0);
      textoImpresion += `Total La Perla: ${totalPerla.toFixed(2)}€\n\n`;
    }

    textoImpresion += `Fecha: ${fecha}`;

    // Aquí puedes integrar la función de impresión que tengas
    // Por ahora, mostramos en consola y alert para simular impresión
    console.log('Imprimiendo ticket:\n' + textoImpresion);
    alert('Ticket impreso:\n' + textoImpresion);

    // Guardar en historial
    guardarEnHistorial(fecha, productosChamos, productosPerla);

    // Limpiar después de imprimir
    resetAll();
  }

  function guardarEnHistorial(fecha, chamos, perla) {
    const historial = JSON.parse(localStorage.getItem('historialTickets')) || [];

    // Clonar arrays para almacenar y evitar referencias
    const chamosClone = chamos.map(p => ({...p}));
    const perlaClone = perla.map(p => ({...p}));

    historial.push({
      fecha,
      chamos: chamosClone,
      perla: perlaClone,
    });

    localStorage.setItem('historialTickets', JSON.stringify(historial));
    mostrarHistorial();
  }

  function mostrarHistorial() {
    const historial = JSON.parse(localStorage.getItem('historialTickets')) || [];
    const divHistorial = document.getElementById('historial');

    if(historial.length === 0) {
      divHistorial.innerHTML = '<h2>Historial de Tickets</h2><p>No hay tickets impresos aún.</p>';
      return;
    }

    let html = '<h2>Historial de Tickets</h2>';
    historial.forEach((ticket, index) => {
      html += `<div><h3>Ticket ${index + 1} - ${ticket.fecha}</h3>`;

      if (ticket.chamos.length > 0) {
        html += '<strong>Los Chamos:</strong><ul>';
        ticket.chamos.forEach(p => {
          html += `<li>${p.nombre} - ${p.precio.toFixed(2)}€</li>`;
        });
        let totalChamos = ticket.chamos.reduce((acc, p) => acc + p.precio, 0);
        html += `</ul><p>Total Los Chamos: ${totalChamos.toFixed(2)}€</p>`;
      }

      if (ticket.perla.length > 0) {
        html += '<strong>La Perla del Caribe:</strong><ul>';
        ticket.perla.forEach(p => {
          html += `<li>${p.nombre} - ${p.precio.toFixed(2)}€</li>`;
        });
        let totalPerla = ticket.perla.reduce((acc, p) => acc + p.precio, 0);
        html += `</ul><p>Total La Perla: ${totalPerla.toFixed(2)}€</p>`;
      }

      let totalGeneral = ticket.chamos.reduce((acc, p) => acc + p.precio, 0) +
                         ticket.perla.reduce((acc, p) => acc + p.precio, 0);

      html += `<p><strong>Total General: ${totalGeneral.toFixed(2)}€</strong></p></div>`;
    });

    divHistorial.innerHTML = html;
  }

  function resetAll() {
    productosChamos = [];
    productosPerla = [];
    actualizarTickets();
  }

  // Mostrar historial al cargar
  mostrarHistorial();
  actualizarTickets();

</script>

</body>
</html>
